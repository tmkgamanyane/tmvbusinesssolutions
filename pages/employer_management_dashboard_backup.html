<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management Dashboard - TMV Business Solutions</title>
    <link rel="stylesheet" href="../styles/employer_management_dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="../scripts/mobile-responsive.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-content">
            <div class="logo-section">
                <img src="../logos/TMV_Logo.png" alt="TMV Logo" class="logo">
                <h1>Management Dashboard</h1>
            </div>
            <div class="user-section">
                <div class="user-info">
                    <i class="fas fa-user-tie"></i>
                    <span id="userName">Manager</span>
                    <span class="role-badge management">Management</span>
                </div>
                <button id="logoutBtn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
            <!-- Hamburger Menu Button -->
        <button class="hamburger" id="hamburgerMenu" aria-label="Toggle navigation menu">
            <span></span>
            <span></span>
            <span></span>
        </button>
    </header>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Main Container -->
    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="#overview" class="nav-link active" data-section="overview">
                    <i class="fas fa-chart-line"></i>
                    <span>Overview</span>
                </a>
                <a href="#job-posting" class="nav-link" data-section="job-posting">
                    <i class="fas fa-edit"></i>
                    <span>üìù Job Posting</span>
                </a>
                <a href="#applications" class="nav-link" data-section="applications">
                    <i class="fas fa-users"></i>
                    <span>üë• Applications</span>
                </a>
                <a href="#reporting" class="nav-link" data-section="reporting">
                    <i class="fas fa-file-alt"></i>
                    <span>üìä Reporting</span>
                </a>
                <a href="#analytics" class="nav-link" data-section="analytics">
                    <i class="fas fa-chart-bar"></i>
                    <span>üìà Analytics</span>
                </a>
                <a href="#management" class="nav-link" data-section="management">
                    <i class="fas fa-briefcase"></i>
                    <span>üëî Management</span>
                </a>
                <a href="#team" class="nav-link" data-section="team">
                    <i class="fas fa-users-cog"></i>
                    <span>Team Overview</span>
                </a>
                <a href="#permissions" class="nav-link" data-section="permissions">
                    <i class="fas fa-user-shield"></i>
                    <span>User Permissions</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Overview Section -->
            <section id="overview" class="content-section active">
                <div class="section-header">
                    <div>
                        <h2><i class="fas fa-chart-line"></i> Team Overview</h2>
                        <p>Monitor team performance and workflow</p>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon tasks">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="activeTasks">0</h3>
                            <p>Active Tasks</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon pending">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="pendingJobs">0</h3>
                            <p>Pending Approvals</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon team">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="teamSize">0</h3>
                            <p>Team Members</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon completed">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="completedTasks">0</h3>
                            <p>Completed This Week</p>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                    <div class="action-grid">
                        <button class="action-card" onclick="managementDashboard.showSection('tasks')">
                            <i class="fas fa-plus-circle"></i>
                            <span>Assign New Task</span>
                        </button>
                        <button class="action-card" onclick="managementDashboard.showSection('jobs')">
                            <i class="fas fa-check-square"></i>
                            <span>Review Jobs</span>
                        </button>
                        <button class="action-card" onclick="managementDashboard.showSection('team')">
                            <i class="fas fa-users"></i>
                            <span>View Team</span>
                        </button>
                        <button class="action-card" onclick="managementDashboard.showSection('analytics')">
                            <i class="fas fa-chart-bar"></i>
                            <span>View Reports</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Task Management Section -->
            <section id="tasks" class="content-section">
                <div class="section-header">
                    <div>
                        <h2><i class="fas fa-tasks"></i> Task Management</h2>
                        <p>Assign and monitor tasks</p>
                    </div>
                    <button id="assignTaskBtn" class="btn-primary">
                        <i class="fas fa-plus"></i> Assign New Task
                    </button>
                </div>

                <!-- Task Filters -->
                <div class="filters">
                    <button class="filter-btn active" data-filter="all">All Tasks</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="in_progress">In Progress</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                </div>

                <!-- Tasks Grid -->
                <div id="tasksContainer" class="tasks-grid">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i> Loading tasks...
                    </div>
                </div>
            </section>

            <!-- Job Approvals Section -->
            <section id="jobs" class="content-section">
                <div class="section-header">
                    <div>
                        <h2><i class="fas fa-briefcase"></i> Job Approvals</h2>
                        <p>Review and approve job postings</p>
                    </div>
                </div>

                <!-- Pending Jobs -->
                <div id="pendingJobsContainer" class="jobs-grid">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i> Loading pending jobs...
                    </div>
                </div>
            </section>

            <!-- Team Overview Section -->
            <section id="team" class="content-section">
                <div class="section-header">
                    <div>
                        <h2><i class="fas fa-users"></i> Team Overview</h2>
                        <p>View team members and their performance</p>
                    </div>
                </div>

                <!-- Team Members Grid -->
                <div id="teamContainer" class="team-grid">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i> Loading team data...
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="content-section">
                <div class="section-header">
                    <div>
                        <h2><i class="fas fa-chart-bar"></i> Performance Analytics</h2>
                        <p>Team performance metrics and insights</p>
                    </div>
                </div>

                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h3><i class="fas fa-chart-line"></i> Task Completion Rate</h3>
                        <div class="metric-display">
                            <span class="metric-value" id="completionRate">0%</span>
                            <p>Tasks completed on time this month</p>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <h3><i class="fas fa-clock"></i> Average Response Time</h3>
                        <div class="metric-display">
                            <span class="metric-value" id="avgResponseTime">0h</span>
                            <p>Average time to complete tasks</p>
                        </div>
                    </div>
                </div>
            </section>

<!-- Job Posting Section -->
<section id="job-posting" class="content-section">
    <div class="section-header">
        <div>
            <h2><i class="fas fa-edit"></i> üìù Job Posting Management</h2>
            <p>Create, edit, and manage job postings</p>
        </div>
        <button class="btn btn-primary" id="createJobBtn">
            <i class="fas fa-plus"></i> Create New Job
        </button>
    </div>

    <!-- Job Posting Actions -->
    <div class="action-cards-grid">
        <div class="action-card" id="createPostCard">
            <i class="fas fa-plus-circle"></i>
            <h3>Create Post</h3>
            <p>Create new job postings</p>
            <span class="permission-badge">canCreatePost</span>
        </div>
        <div class="action-card" id="writePostCard">
            <i class="fas fa-pen"></i>
            <h3>Write Post</h3>
            <p>Write job descriptions</p>
            <span class="permission-badge">canWritePost</span>
        </div>
        <div class="action-card" id="editPostCard">
            <i class="fas fa-edit"></i>
            <h3>Edit Post</h3>
            <p>Edit existing job posts</p>
            <span class="permission-badge">canEditPost</span>
        </div>
        <div class="action-card" id="deletePostCard">
            <i class="fas fa-trash-alt"></i>
            <h3>Delete Post</h3>
            <p>Remove job postings</p>
            <span class="permission-badge">canDeletePost</span>
        </div>
        <div class="action-card" id="assignPostCard">
            <i class="fas fa-user-plus"></i>
            <h3>Assign Post</h3>
            <p>Assign jobs to recruiters</p>
            <span class="permission-badge">canAssignPost</span>
        </div>
        <div class="action-card" id="transferPostCard">
            <i class="fas fa-exchange-alt"></i>
            <h3>Transfer Post</h3>
            <p>Transfer job ownership</p>
            <span class="permission-badge">canTransferPost</span>
        </div>
        <div class="action-card" id="withdrawPostCard">
            <i class="fas fa-ban"></i>
            <h3>Withdraw Post</h3>
            <p>Withdraw job postings</p>
            <span class="permission-badge">canWithdrawPost</span>
        </div>
    </div>

    <!-- Jobs List -->
    <div class="jobs-list-container">
        <h3>Active Job Postings</h3>
        <div id="jobPostingsContainer" class="jobs-grid">
            <div class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Loading jobs...
            </div>
        </div>
    </div>
</section>

<!-- Applications Section -->
<section id="applications" class="content-section">
    <div class="section-header">
        <div>
            <h2><i class="fas fa-users"></i> üë• Application Management</h2>
            <p>Review and manage job applications</p>
        </div>
    </div>

    <!-- Application Actions -->
    <div class="action-cards-grid">
        <div class="action-card" id="viewApplicationsCard">
            <i class="fas fa-eye"></i>
            <h3>View Applications</h3>
            <p>View all applications</p>
            <span class="permission-badge">canViewApplications</span>
        </div>
        <div class="action-card" id="reviewApplicationsCard">
            <i class="fas fa-clipboard-check"></i>
            <h3>Review Applications</h3>
            <p>Review candidate submissions</p>
            <span class="permission-badge">canReviewApplications</span>
        </div>
        <div class="action-card" id="shortlistCandidatesCard">
            <i class="fas fa-star"></i>
            <h3>Shortlist Candidates</h3>
            <p>Shortlist qualified candidates</p>
            <span class="permission-badge">canShortlistCandidates</span>
        </div>
        <div class="action-card" id="rejectCandidatesCard">
            <i class="fas fa-times-circle"></i>
            <h3>Reject Candidates</h3>
            <p>Decline applications</p>
            <span class="permission-badge">canRejectCandidates</span>
        </div>
        <div class="action-card" id="scheduleInterviewsCard">
            <i class="fas fa-calendar-alt"></i>
            <h3>Schedule Interviews</h3>
            <p>Schedule candidate interviews</p>
            <span class="permission-badge">canScheduleInterviews</span>
        </div>
    </div>

    <!-- Applications List -->
    <div class="applications-container">
        <div class="filter-tabs">
            <button class="filter-tab active" data-filter="all">All Applications</button>
            <button class="filter-tab" data-filter="pending">Pending Review</button>
            <button class="filter-tab" data-filter="shortlisted">Shortlisted</button>
            <button class="filter-tab" data-filter="rejected">Rejected</button>
        </div>
        <div id="applicationsListContainer" class="applications-list">
            <div class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Loading applications...
            </div>
        </div>
    </div>
</section>

<!-- Reporting Section -->
<section id="reporting" class="content-section">
    <div class="section-header">
        <div>
            <h2><i class="fas fa-file-alt"></i> üìä Reporting & Exports</h2>
            <p>Generate and export recruitment reports</p>
        </div>
    </div>

    <!-- Reporting Actions -->
    <div class="action-cards-grid">
        <div class="action-card" id="reportAppliedCard">
            <i class="fas fa-file-download"></i>
            <h3>Report Applied Candidates</h3>
            <p>Export all applicants report</p>
            <span class="permission-badge">canPullReportApplied</span>
        </div>
        <div class="action-card" id="reportShortlistedCard">
            <i class="fas fa-star"></i>
            <h3>Report Shortlisted</h3>
            <p>Export shortlisted candidates</p>
            <span class="permission-badge">canPullReportShortlisted</span>
        </div>
        <div class="action-card" id="reportRejectedCard">
            <i class="fas fa-times-circle"></i>
            <h3>Report Rejected</h3>
            <p>Export rejected candidates</p>
            <span class="permission-badge">canPullReportRejected</span>
        </div>
        <div class="action-card" id="reportFullCard">
            <i class="fas fa-file-alt"></i>
            <h3>Full Report</h3>
            <p>Comprehensive recruitment report</p>
            <span class="permission-badge">canPullReportFull</span>
        </div>
        <div class="action-card" id="exportReportsCard">
            <i class="fas fa-file-export"></i>
            <h3>Export Reports</h3>
            <p>Export data to CSV/Excel</p>
            <span class="permission-badge">canExportReports</span>
        </div>
    </div>

    <!-- Report Preview -->
    <div class="report-preview-container">
        <h3>Recent Reports</h3>
        <div id="reportsListContainer" class="reports-list">
            <p style="text-align: center; color: #64748b; padding: 2rem;">
                Click on a report type above to generate
            </p>
        </div>
    </div>
</section>

<!-- Management Section -->
<section id="management" class="content-section">
    <div class="section-header">
        <div>
            <h2><i class="fas fa-briefcase"></i> üëî Management Tools</h2>
            <p>Task assignment and team management</p>
        </div>
    </div>

    <!-- Management Actions -->
    <div class="action-cards-grid">
        <div class="action-card" id="assignTasksCard">
            <i class="fas fa-tasks"></i>
            <h3>Assign Tasks</h3>
            <p>Assign tasks to team members</p>
            <span class="permission-badge">canAssignTasks</span>
        </div>
        <div class="action-card" id="approveJobsCard">
            <i class="fas fa-check-circle"></i>
            <h3>Approve Jobs</h3>
            <p>Approve job postings</p>
            <span class="permission-badge">canApproveJobs</span>
        </div>
        <div class="action-card" id="manageTeamCard">
            <i class="fas fa-users-cog"></i>
            <h3>Manage Team</h3>
            <p>Manage team members</p>
            <span class="permission-badge">canManageTeam</span>
        </div>
    </div>

    <!-- Task Management -->
    <div class="management-container">
        <h3>Team Tasks</h3>
        <div class="task-filters">
            <button class="filter-btn active" data-filter="all">All Tasks</button>
            <button class="filter-btn" data-filter="pending">Pending</button>
            <button class="filter-btn" data-filter="in-progress">In Progress</button>
            <button class="filter-btn" data-filter="completed">Completed</button>
        </div>
        <div id="managementTasksContainer" class="tasks-grid">
            <div class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Loading tasks...
            </div>
        </div>
    </div>

    <!-- Job Approvals -->
    <div class="approvals-container" style="margin-top: 2rem;">
        <h3>Pending Job Approvals</h3>
        <div id="pendingJobsContainer" class="jobs-grid">
            <div class="loading-state">
                <i class="fas fa-spinner fa-spin"></i> Loading pending jobs...
            </div>
        </div>
    </div>
</section>


                        <!-- User Permissions Section -->
            <section id="permissions" class="content-section">
                <div class="section-header">
                    <div>
                        <h2><i class="fas fa-user-shield"></i> User Permissions Management</h2>
                        <p>Manage HR team access and permissions</p>
                    </div>
                </div>

                <div class="info-banner">
                    <i class="fas fa-info-circle"></i>
                    <p><strong>Management Privilege:</strong> You can view and manage permissions for HR & Recruitment staff. Use this to control what your team members can do in the system.</p>
                </div>

                <div id="permissionsUsersContainer" class="users-grid">
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i> Loading users...
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Edit Permissions Modal -->
    <div id="permissionsModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-user-shield"></i> Edit User Permissions</h2>
                <span class="close-permissions">&times;</span>
            </div>

            <div class="user-info-banner">
                <div class="user-info-row">
                    <strong>User:</strong> <span id="modalUserName"></span>
                </div>
                <div class="user-info-row">
                    <strong>Email:</strong> <span id="modalUserEmail"></span>
                </div>
                <div class="user-info-row">
                    <strong>Role:</strong> <span id="modalUserRole" class="role-badge"></span>
                </div>
            </div>

            <div class="permissions-grid">
                <!-- Job Posting Permissions -->
                <div class="permission-section">
                    <h3><i class="fas fa-briefcase"></i> Job Posting</h3>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canCreatePost">
                        <span>Create Post</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canWritePost">
                        <span>Write Post</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canEditPost">
                        <span>Edit Post</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canDeletePost">
                        <span>Delete Post</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canAssignPost">
                        <span>Assign Post</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canTransferPost">
                        <span>Transfer Post</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canWithdrawPost">
                        <span>Withdraw Post</span>
                    </label>
                </div>

                <!-- Application Management -->
                <div class="permission-section">
                    <h3><i class="fas fa-users"></i> Applications</h3>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canViewApplications">
                        <span>View Applications</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canReviewApplications">
                        <span>Review Applications</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canShortlistCandidates">
                        <span>Shortlist Candidates</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canRejectCandidates">
                        <span>Reject Candidates</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canScheduleInterviews">
                        <span>Schedule Interviews</span>
                    </label>
                </div>

                <!-- Reporting -->
                <div class="permission-section">
                    <h3><i class="fas fa-chart-bar"></i> Reporting</h3>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canPullReportApplied">
                        <span>Report: Applied Candidates</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canPullReportShortlisted">
                        <span>Report: Shortlisted</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canPullReportRejected">
                        <span>Report: Rejected</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canPullReportFull">
                        <span>Report: Full Report</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canExportReports">
                        <span>Export Reports</span>
                    </label>
                </div>

                <!-- Analytics -->
                <div class="permission-section">
                    <h3><i class="fas fa-chart-line"></i> Analytics</h3>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canViewAnalytics">
                        <span>View Analytics</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canViewAllJobs">
                        <span>View All Jobs</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canMonitorPerformance">
                        <span>Monitor Performance</span>
                    </label>
                </div>

                <!-- Management -->
                <div class="permission-section">
                    <h3><i class="fas fa-user-tie"></i> Management</h3>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canAssignTasks">
                        <span>Assign Tasks</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canApproveJobs">
                        <span>Approve Jobs</span>
                    </label>
                    <label class="permission-item">
                        <input type="checkbox" id="perm_canManageTeam">
                        <span>Manage Team</span>
                    </label>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelPermissions">Cancel</button>
                <button type="button" class="btn-primary" id="savePermissions">
                    <i class="fas fa-save"></i> Save Permissions
                </button>
            </div>
        </div>
    </div>

    <!-- Assign Task Modal -->
    <div id="assignTaskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-tasks"></i> Assign New Task</h2>
                <span class="close">&times;</span>
            </div>
            <form id="assignTaskForm">
                <div class="form-group">
                    <label for="taskTitle">Task Title *</label>
                    <input type="text" id="taskTitle" name="title" required>
                </div>
                <div class="form-group">
                    <label for="taskDescription">Description</label>
                    <textarea id="taskDescription" name="description" rows="4"></textarea>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="assignTo">Assign To *</label>
                        <select id="assignTo" name="assignedToId" required>
                            <option value="">Select Team Member</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="priority">Priority *</label>
                        <select id="priority" name="priority" required>
                            <option value="low">Low</option>
                            <option value="medium" selected>Medium</option>
                            <option value="high">High</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dueDate">Due Date</label>
                        <input type="date" id="dueDate" name="dueDate">
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-cancel" id="cancelAssignTask">Cancel</button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-check"></i> Assign Task
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Job Details Modal -->
    <div id="jobDetailsModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2><i class="fas fa-briefcase"></i> Job Details</h2>
                <span class="close">&times;</span>
            </div>
            <div id="jobDetailsContent" class="job-details">
                <!-- Job details will be inserted here -->
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-cancel" id="cancelJobReview">Cancel</button>
                <button type="button" class="btn-danger" id="rejectJobBtn">
                    <i class="fas fa-times"></i> Reject
                </button>
                <button type="button" class="btn-primary" id="approveJobBtn">
                    <i class="fas fa-check"></i> Approve
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script src="../scripts/employer_management_dashboard.js"></script>
</body>
</html>

